// =============================================================================
// RESULTS COMPONENT
// Result cards, metrics, address header, and AI summary
// =============================================================================

@use '../abstracts/variables' as *;
@use '../abstracts/mixins' as *;

// -----------------------------------------------------------------------------
// API Results Grid
// -----------------------------------------------------------------------------
.api-results-grid {
	display: grid;
	grid-template-columns: repeat(2, 1fr);
	gap: 1rem;
	margin-top: 0.875rem;

	@include desktop {
		grid-template-columns: repeat(auto-fit, minmax(max(280px, 48%), 1fr));
	}

	@include mobile {
		grid-template-columns: 1fr;
		gap: 2rem;
	}
}

.api-results-grid-full {
	display: grid;
	grid-template-columns: 1fr;
	gap: 1rem;
	margin-top: 0.875rem;
}

// -----------------------------------------------------------------------------
// Result Cards
// -----------------------------------------------------------------------------
.result-card {
	@include glass-effect('liquid');
	@include card-hover;
	border-radius: var(--radius-surface);
	padding: 1.125rem 1.25rem;
	margin: 0;

	@include desktop {
		padding: 1.5rem;
	}

	pre {
		word-break: break-all;
		white-space: pre-wrap;
	}
}

.box:not(.search-panel .box) {
	@include glass-effect('liquid');
	border-radius: var(--radius-surface);
	padding: 1rem;
	margin-bottom: 1.5rem;

	@include desktop {
		padding: 1.5rem;
	}
}

// -----------------------------------------------------------------------------
// Card Header
// -----------------------------------------------------------------------------
.card-header-title {
	color: var(--text-secondary);
	font-weight: 600;
	font-size: 1.5rem;
	display: flex;
	align-items: center;
	gap: 0.5rem;
	margin-bottom: 0.5rem;
	padding: 0;
	justify-content: space-between;
	@include text-shadow-strong;
}

.card-menu-btn {
	background: none;
	border: none;
	color: var(--text-secondary);
	font-size: 1.5rem;
	line-height: 1;
	padding: 0.25rem 0.5rem;
	cursor: pointer;
	opacity: 0.6;
	transition: opacity 0.15s ease, color 0.15s ease;
	border-radius: var(--radius-sm);
	flex-shrink: 0;
	margin-left: 0.5rem;

	&:hover {
		opacity: 1;
		color: var(--primary);
		background: rgba(0, 0, 0, 0.05);

		[data-theme="dark"] & {
			background: rgba(255, 255, 255, 0.1);
		}
	}

	&.active {
		opacity: 1;
		color: var(--primary);
		background: rgba(13, 148, 136, 0.1);

		[data-theme="dark"] & {
			background: rgba(20, 184, 166, 0.15);
		}
	}
}

// -----------------------------------------------------------------------------
// Raw JSON Section
// -----------------------------------------------------------------------------
.card-raw-json {
	margin-top: 1rem;
	padding-top: 1rem;
	border-top: 1px solid var(--border);
	transition: max-height 0.2s ease, opacity 0.2s ease;
	overflow: hidden;
	max-height: 400px;
	overflow-y: auto;

	pre {
		background: rgba(0, 0, 0, 0.05);
		border-radius: var(--radius-sm);
		padding: 0.75rem;
		font-size: 0.75rem;
		line-height: 1.4;
		color: var(--text-primary);
		overflow-x: auto;
		margin: 0;
		border: 1px solid var(--border);

		[data-theme="dark"] & {
			background: rgba(0, 0, 0, 0.3);
			border-color: rgba(255, 255, 255, 0.1);
		}
	}

	code {
		font-family: $font-family-mono;
		color: var(--text-primary);
	}
}

// -----------------------------------------------------------------------------
// Status Indicators
// -----------------------------------------------------------------------------
.status-dot {
	width: 9px;
	height: 9px;
	border-radius: 50%;
	flex-shrink: 0;

	&.success {
		background: var(--success);
	}

	&.error {
		background: var(--danger);
	}

	&.warning {
		background: var(--warning);
	}
}

.status-badge {
	display: inline-flex;
	align-items: center;
	padding: 0.375rem 0.875rem;
	border-radius: 5px;
	font-size: 0.9375rem;
	font-weight: 600;

	&.good {
		background: var(--success-bg);
		color: var(--success);
	}

	&.moderate {
		background: var(--warning-bg);
		color: var(--warning);
	}

	&.poor {
		background: var(--danger-bg);
		color: var(--danger);
	}
}

// -----------------------------------------------------------------------------
// Metric Display
// -----------------------------------------------------------------------------
.metric-display {
	margin: 0.5rem 0 0.375rem;
}

.metric-value {
	font-size: 3.5rem;
	font-weight: 700;
	color: var(--text-primary);
	line-height: 1;
	letter-spacing: -0.04em;
	font-feature-settings: 'tnum';
	@include text-shadow-strong;

	span {
		font-size: 1.25rem;
		font-weight: 500;
		color: var(--text-muted);
		margin-left: 0.125rem;
	}

	@include mobile {
		font-size: 2rem;
	}
}

.metric-label {
	font-size: 0.85rem;
	font-weight: 700;
	color: var(--text-muted);
	text-transform: uppercase;
	letter-spacing: 0.05em;
	margin-top: 0.375rem;
	opacity: 0.8;
	@include text-shadow-light;
}

.metric-secondary {
	font-size: 1.0625rem;
	color: var(--text-secondary);
	margin-top: 0.625rem;
	line-height: 1.5;

	strong {
		color: var(--text-primary);
		font-weight: 600;
	}
}

.timestamp {
	font-size: 0.75rem;
	font-weight: 400;
	color: var(--text-muted);
	opacity: 0.8;
}

// -----------------------------------------------------------------------------
// Address Header Card
// -----------------------------------------------------------------------------
.address-header-card {
	@include glass-effect('liquid');
	border-radius: var(--radius-lg);
	padding: 1.25rem 1.5rem;
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: 1rem;

	@include mobile {
		flex-direction: column;
		align-items: flex-start;
		padding: 1rem;
		margin-bottom: 0.75rem;
	}
}

.address-info {
	flex: 1;
	min-width: 0;
}

.address-title {
	font-size: 1.625rem;
	font-weight: 700;
	color: var(--text-primary);
	letter-spacing: -0.02em;
	margin: 0 0 0.25rem;
	line-height: 1.2;

	@include mobile {
		font-size: 1.25rem;
	}
}

.address-meta {
	display: flex;
	flex-wrap: wrap;
	gap: 0.75rem;
	align-items: center;
	margin-top: 0.5rem;
}

.address-tag {
	display: inline-flex;
	align-items: center;
	gap: 0.375rem;
	padding: 0.375rem 0.75rem;
	border-radius: 5px;
	font-size: 0.9375rem;
	font-weight: 500;
	background: var(--bg-card-alt);
	color: var(--text-secondary);

	strong {
		color: var(--text-primary);
		font-weight: 600;
	}
}

.address-actions {
	display: flex;
	gap: 0.625rem;
	flex-shrink: 0;

	@include mobile {
		margin-top: 0.75rem;
		width: 100%;
	}

	.btn {
		@include button-secondary;

		@include mobile {
			flex: 1;
			justify-content: center;
		}
	}

	.btn-primary {
		@include button-primary;
	}
}

.address-buttons {
	display: flex;
	flex-direction: row;
	gap: 0.5rem;
	flex-wrap: wrap;

	.button {
		flex: 1 1 auto;
		min-width: 100px;
	}

	@include mobile {
		flex-direction: column;

		.button {
			width: 100%;
		}
	}
}

// -----------------------------------------------------------------------------
// AI Summary Card
// -----------------------------------------------------------------------------
.ai-summary-card {
	@include glass-effect('liquid');
	border-radius: var(--radius-lg);
	padding: 1.5rem;
	margin-top: 1rem;
	grid-column: 1 / -1;

	&.ai-summary-error {
		background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%);
		border-color: #fde047;

		[data-theme="dark"] & {
			background: linear-gradient(135deg, #422006 0%, #713f12 100%);
			border-color: #a16207;
		}
	}
}

.ai-summary-header {
	display: flex;
	align-items: center;
	gap: 0.75rem;
	margin-bottom: 1rem;
	flex-wrap: wrap;
}

.ai-icon {
	font-size: 1.75rem;
}

.ai-title {
	font-size: 1.25rem;
	font-weight: 700;
	color: var(--text-primary);
	letter-spacing: -0.01em;
}

.ai-badge {
	margin-left: auto;
	padding: 0.25rem 0.75rem;
	border-radius: 9999px;
	font-size: 0.75rem;
	font-weight: 600;
	background: rgba(14, 165, 233, 0.15);
	color: #0284c7;
	border: 1px solid rgba(14, 165, 233, 0.3);

	[data-theme="dark"] & {
		background: rgba(56, 189, 248, 0.15);
		color: #38bdf8;
		border-color: rgba(56, 189, 248, 0.3);
	}
}

.ai-summary-content {
	font-size: 1rem;
	line-height: 1.7;
	color: var(--text-secondary);
	max-height: 300px;
	overflow-y: auto;
	padding-right: 0.75rem;

	strong {
		color: var(--text-primary);
		font-weight: 600;
	}
}

// -----------------------------------------------------------------------------
// Section Headers
// -----------------------------------------------------------------------------
.section-header {
	display: flex;
	align-items: center;
	gap: 0.625rem;
	margin-bottom: 0.875rem;
	padding-bottom: 0.625rem;
	border-bottom: 2px solid var(--border);

	h4 {
		margin: 0;
		font-size: 1.125rem;
		font-weight: 800;
		color: var(--text-primary);
		text-transform: uppercase;
		letter-spacing: 0.05em;
		@include text-shadow-light;
	}
}

.section-icon {
	font-size: 1.5rem;
	filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.15));
}

.summary-stats-inline {
	display: flex;
	gap: 1rem;
	margin-left: auto;
}

.summary-stat-inline {
	font-size: 0.9375rem;
	font-weight: 500;
	color: var(--text-muted);

	.count {
		font-weight: 700;
		color: var(--text-primary);
	}

	&.success .count {
		color: var(--success);
	}
}

// -----------------------------------------------------------------------------
// Tier Section
// -----------------------------------------------------------------------------
.tier-section {
	margin-bottom: 1.5rem;

	&:last-child {
		margin-bottom: 0;
	}
}

// -----------------------------------------------------------------------------
// Raw Data Toggle
// -----------------------------------------------------------------------------
.raw-data-toggle {
	margin-top: 1rem;
	padding-top: 0.875rem;
	border-top: 1px solid var(--border);

	summary {
		cursor: pointer;
		font-size: 0.875rem;
		color: var(--text-muted);
		font-weight: 500;
		transition: color 0.15s;
		display: inline-flex;
		align-items: center;
		gap: 0.375rem;

		&:hover {
			color: var(--text-secondary);
		}

		&::before {
			content: '{ }';
			font-family: monospace;
			font-size: 0.8125rem;
		}
	}

	pre {
		margin-top: 0.625rem;
		padding: 0.875rem;
		background: var(--bg-dark);
		color: #a1a1aa;
		border-radius: var(--radius-sm);
		font-size: 0.8125rem;
		max-height: 200px;
		overflow-y: auto;
		font-family: $font-family-mono;
		line-height: 1.4;
	}
}

// -----------------------------------------------------------------------------
// Loading States
// -----------------------------------------------------------------------------
.loading-container {
	@include flex-column;
	align-items: center;
	justify-content: center;
	padding: 3rem 1.5rem;
	text-align: center;
}

.loading-spinner {
	width: 44px;
	height: 44px;
	border: 3px solid var(--border);
	border-top-color: var(--primary);
	border-radius: 50%;
	animation: spin 0.8s linear infinite;
}

.loading-status {
	margin-top: 1.25rem;
	font-size: 0.9375rem;
	color: var(--text-secondary);
	min-height: 1.5em;
}

// -----------------------------------------------------------------------------
// Skeleton Loading
// -----------------------------------------------------------------------------
.skeleton-line {
	background: linear-gradient(90deg, var(--border) 25%, var(--bg-card-alt) 50%, var(--border) 75%);
	background-size: 200% 100%;
	animation: skeleton-shimmer 1.5s ease-in-out infinite;
	border-radius: var(--radius-sm);
	height: 1rem;

	[data-theme="dark"] & {
		background: linear-gradient(90deg, var(--border-strong) 25%, var(--bg-dark) 50%, var(--border-strong) 75%);
		background-size: 200% 100%;
	}
}

.skeleton-text-block {
	width: 100%;
}

.shimmer {
	animation: shimmer 2s infinite linear;
	background: linear-gradient(to right, #eff1f3 4%, #e2e2e2 25%, #eff1f3 36%);
	background-size: 1000px 100%;
}
